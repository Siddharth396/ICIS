# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1
ServiceAccountName: supdem
environment: ""


vault_agent:
  repository: "artifacts.cha.rbxd.ds/base-image/vault"
  tag: "latest"

consul_template:
  repository: "artifacts.cha.rbxd.ds/base-image/consul-template"
  tag: "alpine"


poller:
  port: 12001
  image:
    repository: "artifacts.cha.rbxd.ds/supdem/snd-eventprocessor-poller"
    tag: "latest"
    pullPolicy: Always
  env_vars:
    COMPlus_EnableDiagnostics: "0"



processor:
  port: 12000
  image:
    repository: "artifacts.cha.rbxd.ds/supdem/processor"
    tag: "latest"
    pullPolicy: Always
  env_vars:
    COMPlus_EnableDiagnostics: "0"
  securityContext:
    readOnlyRootFilesystem: false
    privileged: false
  livenessProbe:
    httpGet:
      path: /internal/health
      port: 12000
    periodSeconds: 30
  resources: 
    limits:
      cpu: 100m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi

nginx:
  port: 8080
  image:
    repository: artifacts.cha.rbxd.ds/base-image/nginx
    tag: alpine3.17 
    pullPolicy: Always
  securityContext:
    privileged: false
  readinessProbe:
    httpGet:
      path: /internal/health/liveness
      port: 8080
      scheme: HTTPS
    initialDelaySeconds: 5
    periodSeconds: 5
  livenessProbe:
    httpGet:
      path: /internal/health/liveness
      port: 8080
      scheme: HTTPS
    periodSeconds: 30

service:
  port: 8080



imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceMonitor:
  enabled: true
  endpoints:
    - interval: 30s
      honorLabels: true
      path: /internal/metrics
      targetPort: 12000
      scheme: http

configmap:
  name: processor-configs

##########################################
# Application configuration (appsettings)
##########################################
application_configmap:
  name: processor-app-configs
###############################################################

vault:
  name: supdem-processor-vault-secret
  url: "https://vault_eu_prod.b2b.regn.net"
  VaultK8sRoleName: "kv-supdem-read"
  VaultK8sAuthPath: "auth/cha/eks-b"
  certificate:
    vault.crt: |-
      -----BEGIN CERTIFICATE-----
      MIIEijCCA3KgAwIBAgIQay0iJoZ+c6NJt7cqchus+zANBgkqhkiG9w0BAQsFADBg
      MRMwEQYKCZImiZPyLGQBGRYDbmV0MRQwEgYKCZImiZPyLGQBGRYEcmVnbjETMBEG
      CgmSJomT8ixkARkWA2IyYjEeMBwGA1UEAxMVYjJiLVJCSVFIU1BLSVAwMDJWLUNB
      MB4XDTE3MDgxNzA5MzY1N1oXDTI3MDgxNzA5NDY1N1owYDETMBEGCgmSJomT8ixk
      ARkWA25ldDEUMBIGCgmSJomT8ixkARkWBHJlZ24xEzARBgoJkiaJk/IsZAEZFgNi
      MmIxHjAcBgNVBAMTFWIyYi1SQklRSFNQS0lQMDAyVi1DQTCCASIwDQYJKoZIhvcN
      AQEBBQADggEPADCCAQoCggEBAMv3KNkRI/WzMqcLwkSsKU3vM5coMtDbqdPccdXU
      MufO94gQXzWsLYN4gUVW2BQq2ULolCzwEDuEep61By2uKw4myr9RHENM8zy7cQXs
      VvrkNiE+cyYa2zxxM34ImJDc19vHdBovX0zcY3jT3uqtdJX42Etvh2zJoAi26SDk
      9miXggePd9eoGfnE6MKxTdCtf3s7AHQxR9Y3Rx+uCMKOSWNN+LterAA2n7qMtu6n
      Uo51ZXmCdJYQDgyvVgS2CgUZwfCwBvD3bCeDwM8FLOr/V/5FDDVvIDmREqQN1eeY
      Y2q7UQTujHRFzF18Iw+Thk1eGV/zyNvaXr8ny7o1uOeIg80CAwEAAaOCAT4wggE6
      MBMGCSsGAQQBgjcUAgQGHgQAQwBBMAsGA1UdDwQEAwIBhjAPBgNVHRMBAf8EBTAD
      AQH/MB0GA1UdDgQWBBQjySkPLCVwclOIUQnzz5V3rO+1WzASBgkrBgEEAYI3FQEE
      BQIDBQAFMIGsBgNVHR8EgaQwgaEwgZ6ggZuggZiGSmh0dHA6Ly9yYmlxaHNwa2lw
      MDAzdi5iMmIucmVnbi5uZXQvQ2VydEVucm9sbC9iMmItUkJJUUhTUEtJUDAwMlYt
      Q0EoNSkuY3JshkpodHRwOi8vcmJpcWhzcGtpcDAwNHYuYjJiLnJlZ24ubmV0L0Nl
      cnRFbnJvbGwvYjJiLVJCSVFIU1BLSVAwMDJWLUNBKDUpLmNybDAjBgkrBgEEAYI3
      FQIEFgQU2RDhuv3cL/CQBA4ZVzMUpO+Tqf4wDQYJKoZIhvcNAQELBQADggEBADHm
      Vhw0S0ICMgXQDpXOp8nraCKsm9LpLcmi/SOtR35AgGQmxAxlPebKgIL3vpUOfnec
      10htfOInwmF2dVheluEoFBPSbh0uXm3+Rm2p44/d6HTo5AkTygOQf3Fdu0IFqvBH
      kXBLyQkgVfH2p3OjIfJAV+6seWBI3n+VvBg+YUVYHIqUCHzmxL07ztKuI7f6ZTuO
      8AvcJzMcsjKkGeUNS3lNimEdI339C93BrBDNzPHZe7LOQr7SiFcIU32hIKfLLkWT
      MM+pxYAJe1wZkDN1XvYgQ+R4W9XItalDf4y4ZwQIpYo60jZLS1OJQJngE3Tu6R2K
      gA9dcD2vlZA86EhY8Mg=
      -----END CERTIFICATE-----

app_container:
  name: cport

container:
  lifecycle:
    preStop:
      exec:
        command: ["/bin/sh", "-c", "sleep 20"]
