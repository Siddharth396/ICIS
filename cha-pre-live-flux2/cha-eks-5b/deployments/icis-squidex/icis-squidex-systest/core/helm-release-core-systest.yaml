apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: icis-squidex-systest
  namespace: icis-squidex-systest
spec:
  releaseName: core-systest
  upgrade:
    remediation:
      remediateLastFailure: false
      strategy: rollback
  values:
    projectName: "core"
    squidex:
      image:
        repository: artifacts.cha.rbxd.ds/automated/icis-squidex # {"$imagepolicy": "flux-system:icis-squidex-systest-core:name"}
        tag: systest-core-1416-7.7.14-master-9209 # {"$imagepolicy": "flux-system:icis-squidex-systest-core:tag"}
      customEnvValues:
        ADMIN__ADMINAPPS__0: core
        ADMIN__ADMINUSERGROUP__0: ICIS_Darwin
        PLUGINS__2: ICIS.EmbargoPlugin.dll
        UI__DISABLESCHEDULEDCHANGES: "'true'"
        CONTENTS__MAXRESULTS: "'5000'"
        CONTENTS__TIMEOUTQUERY: "'00:00:45'"
        EXPOSEDCONFIGURATION__multipleDomains: identity:multipleDomains
      kafka:
        enabled: True
      resources:
        limits:
          cpu: 500m
          memory: 1024Mi
        requests:
          cpu: 200m
          memory: 256Mi
    squidexCli:
      enabled: true
      schedule: "'20 9,12,15,18 * * *'"
      image:
        repository: artifacts.cha.rbxd.ds/automated/icis-squidex-cli # {"$imagepolicy": "flux-system:icis-squidex-cli-systest-core:name"}
        tag: systest-core-94-8.0.1-master-24677 # {"$imagepolicy": "flux-system:icis-squidex-cli-systest-core:tag"} 
    vault_squidex_secrets:
      name: core-squidex-systest-secret
    vault_kafka_secrets:
      name: core-squidex-kafka-systest-secret
      VaultSecretPath: "icis-squidex/core/systest"
