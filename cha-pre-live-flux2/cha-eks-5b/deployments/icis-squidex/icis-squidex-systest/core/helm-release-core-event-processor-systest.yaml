apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: event-processor
  namespace: icis-squidex-systest
spec:
  releaseName: core-event-processor-systest
  values:
    replicaCount: 1
    namespace: "icis-squidex-systest"
    environment: "systest"
    projectName: "core"
    ServiceAccountName: "icis-squidex"
    kafka_consumer:
      image:
        repository: artifacts.cha.rbxd.ds/estream/generic-kafka-consumer
        tag: 3.1.0-vso.1.1002
        pullPolicy: IfNotPresent
      config_env:
        ASPNETCORE_ENVIRONMENT: "systest"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_price_assessments_2: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_commodity_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_location_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_frequency_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_period_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_factory_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_currency_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__Consumer__HandlerConfiguration__public_systest_petchem_measure_unit_1: "http://localhost:80/api/1.0/messageHandler"
        KafkaConsumer_AppSettings__ClusterConfig__SchemaRegistryUrl: "https://psrc-4xrp1.eu-central-1.aws.confluent.cloud"
        KafkaConsumer_AppSettings__Consumer__BrokerUrls: "pkc-l568n.eu-west-1.aws.confluent.cloud:9092"
        KafkaConsumer_AppSettings__Consumer__ConsumerName: "core-consumer-systest-4"
        KafkaConsumer_AppSettings__Consumer__RetryTopic: "private_systest_core_cms_consumer_retry"
        KafkaConsumer_AppSettings__Consumer__FailedTopic: "private_systest_core_cms_consumer_failed"
        KafkaConsumer_AppSettings__Consumer__Topics__0: "public_systest_petchem_price_assessments_2"
        KafkaConsumer_AppSettings__Consumer__Topics__1: "public_systest_petchem_commodity_1"
        KafkaConsumer_AppSettings__Consumer__Topics__2: "public_systest_petchem_location_1"
        KafkaConsumer_AppSettings__Consumer__Topics__3: "public_systest_petchem_frequency_1"
        KafkaConsumer_AppSettings__Consumer__Topics__4: "public_systest_petchem_period_1"
        KafkaConsumer_AppSettings__Consumer__Topics__5: "public_systest_petchem_factory_1"
        KafkaConsumer_AppSettings__Consumer__Topics__6: "public_systest_petchem_currency_1"
        KafkaConsumer_AppSettings__Consumer__Topics__7: "public_systest_petchem_measure_unit_1"
    event_processor:
      image:
        repository: "artifacts.cha.rbxd.ds/automated/icis-squidex/event-processor" # {"$imagepolicy": "flux-system:icis-squidex-event-processor-systest-core:name"}
        tag: systest-core-60-1.0.0-36-g2cbd0df # {"$imagepolicy": "flux-system:icis-squidex-event-processor-systest-core:tag"}
        pullPolicy: IfNotPresent
      config_env:
        ENVIRONMENT: systest
        ASPNETCORE_ENVIRONMENT: systest
        SchemaRegistry__Url: https://psrc-4xrp1.eu-central-1.aws.confluent.cloud/
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__SchemaName: "price-assessments"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__LogicalTypeFields__created_for: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__LogicalTypeFields__period_start_date: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__LogicalTypeFields__period_end_date: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_price_assessments_2__IdentifierFormat: "Prefix_{0}_Suffix"
        Processor__TopicToSchemaMapping__public_systest_petchem_commodity_1__SchemaName: "commodity"
        Processor__TopicToSchemaMapping__public_systest_petchem_commodity_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_commodity_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_commodity_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_commodity_1__IdentifierFormat: "{0}_Suffix_Commodity"
        Processor__TopicToSchemaMapping__public_systest_petchem_location_1__SchemaName: "location"
        Processor__TopicToSchemaMapping__public_systest_petchem_location_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_location_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_location_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_location_1__IdentifierFormat: "Location_Prefix_{0}"
        Processor__TopicToSchemaMapping__public_systest_petchem_frequency_1__SchemaName: "frequency"
        Processor__TopicToSchemaMapping__public_systest_petchem_frequency_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_frequency_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_frequency_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_period_1__SchemaName: "period"
        Processor__TopicToSchemaMapping__public_systest_petchem_period_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_period_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_period_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_factory_1__SchemaName: "factory"
        Processor__TopicToSchemaMapping__public_systest_petchem_factory_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_factory_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_factory_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_currency_1__SchemaName: "currency"
        Processor__TopicToSchemaMapping__public_systest_petchem_currency_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_currency_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_currency_1__LogicalTypeFields__created_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_measure_unit_1__SchemaName: "measure-unit"
        Processor__TopicToSchemaMapping__public_systest_petchem_measure_unit_1__ExcludeFields__0: "metadata"
        Processor__TopicToSchemaMapping__public_systest_petchem_measure_unit_1__LogicalTypeFields__released_on: "timestamp-millis"
        Processor__TopicToSchemaMapping__public_systest_petchem_measure_unit_1__LogicalTypeFields__created_on: "timestamp-millis"
        Squidex__Url: https://core.cosmos.systest.cha.eu-west-1.dev/
        Squidex__AppName: "core"
        Squidex__SkipSchemaCreation: true
    ingress:
      enabled: true
      annotations:
        kubernetes.io/ingress.class: icis-nginx-ingress
        nginx.ingress.kubernetes.io/backend-protocol: HTTPS
        external-dns.alpha.kubernetes.io/hostname: core-event-processor.systest.cha.eu-west-1.dev
        cert-manager.io/cluster-issuer: vault-issuer
      hosts:
        - host: core-event-processor.systest.cha.eu-west-1.dev
          paths:
            - /
          tls: "true"
      tls:
        - hosts:
            - core-event-processor.systest.cha.eu-west-1.dev
          secretName: core-event-processor-systest-cha-eu-west-1-dev
    vault_secrets:
      name: core-event-processor-vault-secret-systest
    vault_secrets_consumer:
      name: core-event-processor-vault-secret-consumer-systest
      VaultSecretPath: "icis-squidex/core/systest"
