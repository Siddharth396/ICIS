apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: hmpage-app
spec:
  interval: 5m0s
  chart:
    spec:
      chart: hmpage-app
      version: 0.1.2
      sourceRef:
        kind: HelmRepository
        name: helm-charts
        namespace: flux-system
  upgrade:
    remediation:
      remediateLastFailure: false
      strategy: rollback
  releaseName: hmpage-app
  values:
    vault_secrets:    
      VaultK8sRoleName: "kv-hmpage-read"
      VaultK8sAuthPath: "cha/eks-5b"
      VaultSecretMount: "kv/cha/k8s"
      VaultAddress: "https://vault.cluster.us-vault-non-prod.azure.lnrsg.io"
      VaultNamespace: dataservices/icis/nonprod
    autoscaling:
      enabled: true
      minReplicas: 1
      maxReplicas: 3
      targetCPUUtilizationPercentage: 80
      targetMemoryUtilizationPercentage: 80